<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LQ79946QV2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-LQ79946QV2');
    </script>

    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
	<title>LabCAS</title>
        <div id="head_template"></div>
<script src="/labcas-ui/assets/js/core/jquery-3.5.1.min.js" type="text/javascript"></script>
    <script>
    function testtest() { console.log('myframe is loaded2'); $('#img_frame').contents().find('#h-navbar-brand').html('Image Viewer');}
    </script>
    <script async type="text/javascript" id="_fed_an_ua_tag" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NASA&subagency=JPL-edrn-labcas"></script>
</head>

<body class="sidebar-mini">
    <div class="wrapper">
        <div id='sidebar_placeholder'></div>
        <div class="main-panel">
            <!-- Navbar -->
            <div id="nav_template"></div>
            <!-- End Navbar -->
            <div class="content">
                <br>
                <br>
                <div class="container-fluid">
                    <div class="row">
                    	<div class="col-md-12">
				<nav aria-label="breadcrumb">
				  <ol id="breadcrumb" class="breadcrumb">

				  </ol>
				</nav>
                    	</div>
                    </div>
                    <div class="wrapper" style="background:white">
                        <!--<a href="#" onclick="loginOmero()">BIGtest</a>-->
                        <div class="col-md-12"><center><img alt='Please wait while this is loading' id="loading_viewer" class="collapse show" height="200px" width="200px" src="/labcas-ui/assets/img/loading.gif"></center></div>
                        <div class="row" id="viewer_content">
                            <div class="col-md-3" style="padding-left: 30px; padding-top: 20px; padding-right: 0px;">
                                <table class="table table-hover" id="image_list_table">
                                    <thead><th style="padding-left: 5px;">Image List</th></thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                            <div class="col-md-9" style="overflow: hidden; padding-left: 0px">
                                        <iframe id="img_frame" style="position: relative;top: -40px; border-top:1px;" frameBorder="0" height="900px" width="100%" onload="testtest();"></iframe>
                            </div>
                        </div>
                    </div>
                            <!--<div class="col-md-12" style="overflow: hidden; padding-left: 0px">
                                        <iframe id="test"  frameBorder="0" height="900px" width="100%" src="https://omero-test.jpl.nasa.gov/webclient/img_detail/1341/?dataset=115"</iframe>
                            </div>-->
		</div>
	    </div>
	</div>
    </div>
    <footer role='contentinfo' class='labcas-footer'  id="footer_template">
    </footer>
    </div>
</div>
                          
</body>
<!--   Core JS Files   -->
<script src="/labcas-ui/assets/js/core/popper.min.js" type="text/javascript"></script>
<script src="/labcas-ui/assets/js/core/bootstrap.min.js" type="text/javascript"></script>
<!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
<script src="/labcas-ui/assets/js/plugins/bootstrap-switch.js"></script>
<!--  Chartist Plugin  -->
<script src="/labcas-ui/assets/js/plugins/chartist.min.js"></script>
<!--  Notifications Plugin    -->
<script src="/labcas-ui/assets/js/plugins/bootstrap-notify.js"></script>
<!--  jVector Map  -->
<script src="/labcas-ui/assets/js/plugins/jquery-jvectormap.js" type="text/javascript"></script>
<!--  Plugin for Date Time Picker and Full Calendar Plugin-->
<script src="/labcas-ui/assets/js/plugins/moment.min.js"></script>
<!--  DatetimePicker   -->
<script src="/labcas-ui/assets/js/plugins/bootstrap-datetimepicker.js"></script>
<!--  Sweet Alert  -->
<script src="/labcas-ui/assets/js/plugins/sweetalert2.min.js" type="text/javascript"></script>
<!--  Tags Input  -->
<script src="/labcas-ui/assets/js/plugins/bootstrap-tagsinput.js" type="text/javascript"></script>
<!--  Sliders  -->
<script src="/labcas-ui/assets/js/plugins/nouislider.js" type="text/javascript"></script>
<!--  Bootstrap Select  -->
<script src="/labcas-ui/assets/js/plugins/bootstrap-selectpicker.js" type="text/javascript"></script>
<!--  jQueryValidate  -->
<script src="/labcas-ui/assets/js/plugins/jquery.validate.min.js" type="text/javascript"></script>
<!--  Plugin for the Wizard, full documentation here: https://github.com/VinceG/twitter-bootstrap-wizard -->
<script src="/labcas-ui/assets/js/plugins/jquery.bootstrap-wizard.js"></script>
<!--  Bootstrap Table Plugin -->
<script src="/labcas-ui/assets/js/plugins/bootstrap-table.js"></script>
<!--  DataTable Plugin -->
<script src="/labcas-ui/assets/js/plugins/jquery.dataTables.min.js"></script>
<!--  Full Calendar   -->
<script src="/labcas-ui/assets/js/plugins/fullcalendar.min.js"></script>
<!-- Control Center for Now Ui Dashboard: parallax effects, scripts for the example pages etc -->
<script src="/labcas-ui/assets/js/light-bootstrap-dashboard.js?v=2.0.1" type="text/javascript"></script>
<!-- Light Dashboard DEMO methods, don't include it in your project! -->
<link href="/labcas-ui/assets/css/labcas/custom.css" rel="stylesheet" />
<script src="/labcas-ui/assets/js/plugins/js.cookie.js"></script>
<script src="/labcas-ui/assets/js/labcas/labcas-sidebar.js"></script>
<script src="/labcas-ui/assets/js/labcas/authentication.js?version=5.5.2"></script>
<script src="/labcas-ui/assets/js/labcas/utils.js?version=5.5.2"></script>
<script src="/labcas-ui/assets/js/labcas/search.js?version=5.5.2"></script>
<script type="text/javascript">
    $('#viewer_content').hide(1);
	initCookies();
    $(document).ready(function() {
        var temp_image_data = "{\"BBD_Pathology_Slide_Images/Source_BBD_Pathology_Slide_Images/1.33118484.1.svs\":[\"/usr/local/labcas/backend/archive/BBD_Pathology_Slide_Images/Source_BBD_Pathology_Slide_Images\",\"186647.svs\",\"1\",\"BBD_Pathology_Slide_Images/Source_BBD_Pathology_Slide_Images/1.33118484.1.svs\",\"159\"],\"BBD_Pathology_Slide_Images/Source_BBD_Pathology_Slide_Images/1.33119893.1.svs\":[\"/usr/local/labcas/backend/archive/BBD_Pathology_Slide_Images/Source_BBD_Pathology_Slide_Images\",\"EX13-0870-1-HE-EH.svs\",\"1\",\"BBD_Pathology_Slide_Images/Source_BBD_Pathology_Slide_Images/1.33119893.1.svs\",\"152\"],\"BBD_Pathology_Slide_Images/Source_BBD_Pathology_Slide_Images/1.33120006.1.svs\":[\"/usr/local/labcas/backend/archive/BBD_Pathology_Slide_Images/Source_BBD_Pathology_Slide_Images\",\"scan-resolution1.ome.tif\",\"1\",\"BBD_Pathology_Slide_Images/Source_BBD_Pathology_Slide_Images/1.33120006.1.svs\",\"155\"],\"Combined_Imaging_and_Blood_Biomarkers_for_Breast_Cancer_Diagnosis/AB0262/Primary/Truth/2D/FFDM/RAW/AB0262_TRU_4B_1_PRO_LCC.png\":[\"/usr/local/labcas/backend/archive/Combined_Imaging_and_Blood_Biomarkers_for_Breast_Cancer_Diagnosis/AB0262/Primary/Truth/2D/FFDM/RAW\",\"testRGB.ome.tif\",\"1\",\"Combined_Imaging_and_Blood_Biomarkers_for_Breast_Cancer_Diagnosis/AB0262/Primary/Truth/2D/FFDM/RAW/AB0262_TRU_4B_1_PRO_LCC.png\",\"158\"],\"Combined_Imaging_and_Blood_Biomarkers_for_Breast_Cancer_Diagnosis/AB0459/Primary/Truth/2D/FFDM/RAW/scan.qptiff\":[\"/usr/local/labcas/backend/archive/Combined_Imaging_and_Blood_Biomarkers_for_Breast_Cancer_Diagnosis/AB0459/Primary/Truth/2D/FFDM/RAW\",\"scan.qptiff\",\"1\",\"Combined_Imaging_and_Blood_Biomarkers_for_Breast_Cancer_Diagnosis/AB0459/Primary/Truth/2D/FFDM/RAW/scan.qptiff\",\"53\"]}";
        localStorage.setItem("images",temp_image_data);
        localStorage.setItem("image_data",temp_image_data);
        $( "#head_template" ).load("/labcas-ui/templates.html #head_template");
        $( "#nav_template" ).load("/labcas-ui/templates.html?version=5.5.2 #nav_template", function() {
            $( "#username_placeholder_second" ).text(Cookies.get('user'));
            if (Cookies.get('user') == "Sign in"){$( "#username_placeholder_third" ).text(Cookies.get('user'));}
            set_cart_status();
        });

	$( "#footer_template" ).load("/labcas-ui/templates.html?version=5.5.2 #footer_template_"+localStorage.getItem("environment_name"));
    $( "#sidebar_placeholder" ).load("/labcas-ui/sidebar_"+localStorage.getItem("environment_name")+".html?version=5.5.2" );
    $("#loggedout_msg").hide(); 


        
		var breadcrumb = '<li class="breadcrumb-item"><a href="/labcas-ui/m/index.html">Home</a></li>';
        if (Cookies.get("login_redirect") && Cookies.get("login_redirect").includes("dataset_id=")){
            var dataset_id = Cookies.get("login_redirect").split("dataset_id=")[1];
            var data_split = dataset_id.split("/");
            var url_prefix = "";
            for (i = 0; i < data_split.length; i++) {
                if(i == 0){
                    breadcrumb += '<li class="breadcrumb-item active" aria-current="page"><a href="/labcas-ui/c/index.html?collection_id='+data_split[i]+'">'+data_split[i].replace(/_/g," ")+'</a></li>';
                }else if (i == data_split.length -1){
                    breadcrumb += '<li class="breadcrumb-item active" aria-current="page"><a href="'+Cookies.get("login_redirect")+'">'+data_split[i].replace(/_/g," ")+'</a></li>';
                }else{
                    breadcrumb += '<li class="breadcrumb-item active" aria-current="page"><a href="/labcas-ui/d/index.html?dataset_id='+data_split.slice(0,i+1).join("/")+'">'+data_split[i].replace(/_/g," ")+'</a></li>';
                }
            }
            breadcrumb += '<li class="breadcrumb-item active" aria-current="page">Image Viewer</li>';
        }
        if (Cookies.get("login_redirect") && Cookies.get("login_redirect").includes("search=")){
            breadcrumb += '<li class="breadcrumb-item active" aria-current="page"><a href="'+Cookies.get("login_redirect")+'">Search</a></li>';
            breadcrumb += '<li class="breadcrumb-item active" aria-current="page">Image Viewer</li>';
        }
        var get_var = get_url_vars();
        var images = [];
        if (localStorage.getItem('omeros') && localStorage.getItem('omeros')!= ""){
            images = JSON.parse(localStorage.getItem('image_data'));
        }

        if (!(Cookies.get("login_redirect") && Cookies.get("login_redirect").includes("dataset_id=")) && !(Cookies.get("login_redirect") && Cookies.get("login_redirect").includes("search=")) && (images && images.length > 0 && images[0].length == 4)){
            var data_split = images[0][3].split("/");

            var url_prefix = "";
            for (i = 0; i < data_split.length-1; i++) {
                if(i == 0){
                    breadcrumb += '<li class="breadcrumb-item active" aria-current="page"><a href="/labcas-ui/c/index.html?collection_id='+data_split[i]+'">'+data_split[i].replace(/_/g," ")+'</a></li>';
                }else if (i == data_split.length -1){
                    breadcrumb += '<li class="breadcrumb-item active" aria-current="page"><a href="'+Cookies.get("login_redirect")+'">'+data_split[i].replace(/_/g," ")+'</a></li>';
                }else{
                    breadcrumb += '<li class="breadcrumb-item active" aria-current="page"><a href="/labcas-ui/d/index.html?dataset_id='+data_split.slice(0,i+1).join("/")+'">'+data_split[i].replace(/_/g," ")+'</a></li>';
                }
            }
            breadcrumb += '<li class="breadcrumb-item active" aria-current="page">Image Viewer</li>';
        }
        if (!(Cookies.get("login_redirect") && Cookies.get("login_redirect").includes("dataset_id=")) && !(Cookies.get("login_redirect") && Cookies.get("login_redirect").includes("search=")) && get_var["fileid"]){
            var data_split = get_var["fileid"].split("/");

            var url_prefix = "";
            for (i = 0; i < data_split.length-1; i++) {
                if(i == 0){
                    breadcrumb += '<li class="breadcrumb-item active" aria-current="page"><a href="/labcas-ui/c/index.html?collection_id='+data_split[i]+'">'+data_split[i].replace(/_/g," ")+'</a></li>';
                }else if (i == data_split.length -1){
                    breadcrumb += '<li class="breadcrumb-item active" aria-current="page"><a href="'+Cookies.get("login_redirect")+'">'+data_split[i].replace(/_/g," ")+'</a></li>';
                }else{
                    breadcrumb += '<li class="breadcrumb-item active" aria-current="page"><a href="/labcas-ui/d/index.html?dataset_id='+data_split.slice(0,i+1).join("/")+'">'+data_split[i].replace(/_/g," ")+'</a></li>';
                }
            }
            breadcrumb += '<li class="breadcrumb-item active" aria-current="page">Image Viewer</li>';
        }
		$('#breadcrumb').html(breadcrumb);

        if (get_var["fileid"]){
	      Cookies.set("login_redirect", "/labcas-ui/z/index.html?fileid="+get_var["fileid"])
        }
        console.log(get_var["fileid"]);
        //showOmeroImage(get_var["fileid"]);
        loadBaseUrls(loadProjects);
    });



	window.onbeforeunload = function (event) {
	    if (typeof event == 'undefined') {
		event = window.event;
	    }
	    if (event) {
		//localStorage.setItem("image_data","");
		//localStorage.setItem("image","");
	    }
	};

</script>

</html>
