<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LQ79946QV2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-LQ79946QV2');
    </script>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
	<title>LabCAS</title>
	<div id="head_template"></div>
    <style>
        input.tt-input {width:100px;}
    </style>
    <script async type="text/javascript" id="_fed_an_ua_tag" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NASA&subagency=JPL-edrn-labcas"></script>
</head>

<body class="sidebar-mini">
    <div class="wrapper">
        <div id='sidebar_placeholder'></div>
        <div class="main-panel">
            <!-- Navbar -->
            <div id="nav_template"></div>
            <!-- End Navbar -->
            <div class="content">
                <br>
                <br>
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-3 col-sm-6" id="collection_name_template">
                        </div>
                        <div class="col-lg-3 col-sm-6" id="dataset_stat_template">
                        </div>
                        <div class="col-lg-3 col-sm-6" id="file_stat_template">
                        </div>
                        <div class="col-lg-3 col-sm-6" id="download_collection_template">
                        </div>
                    </div>
                    <div class="row">
                    	<div class="col-md-12">
				<nav aria-label="breadcrumb">
				  <ol class="breadcrumb">
					<li class="breadcrumb-item"><a href="/labcas-ui/m/index.html">Home</a></li>
					<li id="breadcrumb_collection" class="breadcrumb-item active" aria-current="page"></li>
				  </ol>
				</nav>
                    	</div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card ">
                                <div class="card-header">
                                    <h4 class="card-title"><div id="collectiontitle"></div></h4>
                                     <p class="card-category">Collection Details</p>
                                </div>
                                <div class="card-body">
                                            <div class="table-responsive">
                                                <table class="table" id="collectiondetails-table" style="table-layout: fixed;">
                                                    <tbody>
							<center><img alt='Please wait while this is loading' id="loading_collection" class="collapse show" height="50px" width="50px" src="/labcas-ui/assets/img/loading.gif"></center>
                                                    </tbody>
                                                </table>
                                            </div>
                                        
                                </div>
                            </div>
                        </div>
			<div class="col-md-6 ml-auto mr-auto">
				<div class="col-md-12 ml-auto mr-auto" id="collection_level_files">
                                    <div class="card card-tasks">
                                        <div class="card-header ">
                                            <h4 class="card-title">Collection Level Files</h4>
                                            <p class="card-category">Explore or Download</p>
                                        </div>  
                                        <div class="card-body" style="padding: 0px 15px 10px 15px">
                                            <div class="table-full-width">
                                                <div id="metadata_div">
                                                        <center><img alt='Please wait while this is loading' id="loading_metadata" class="collapse show" height="50px" width="50px" src="/labcas-ui/assets/img/loading.gif"></center>
                                                </div>  
                                            </div>  
                                        </div>  
                                    </div>  
                                </div>  

				<div class="col-md-12 ml-auto mr-auto" id="datasets_in_collection">
				    <div class="card card-tasks">
					<div class="card-header ">
					    <h4 class="card-title">Datasets in this Collection</h4>
					    <p class="card-category">Explore or Download</p>
					</div>
					<div class="card-body">
                                    Add Folder Grouping Heirarchy:
                                    <hr style="padding:0; padding-bottom:5px; margin: 0">
                        <input id="view_tags" type="text" value="1. Cohort,2. Fixative,3. Study" /><div>
                            <select id="view_tag_select" class="form-control input-sm" data-style="btn-default btn-outline" data-menu-style="dropdown-blue"><option>Default</option></select>
					    <div class="table-full-width">
                        <div id="hierarchy_">
                            <center><img alt='Please wait while this is loading' id="loading_hierarchy" class="collapse hide" height="50px" width="50px" src="/labcas-ui/assets/img/loading.gif"></center>
                        </div>
						<div id="datasets-table">       
							<center><img alt='Please wait while this is loading' id="loading_dataset" class="collapse show" height="50px" width="50px" src="/labcas-ui/assets/img/loading.gif"></center>
						</div>

					    </div>
					</div>
				    </div>
				</div>
		 	</div>
		</div>

		<div id='children-files' style="display: none" class="col-md-12 ml-auto mr-auto">
                            <div class="card card-tasks">
                                <div class="card-header ">
                                    <h4 class="card-title" id="files-title">Files in this Collection</h4>

                                </div>
                                <div class="card-body">
                                <button type="submit" onclick="download_files('files-table');" class="btn btn-primary">Download Selected</button>
                                <button type="submit" onclick="download_dataset(dataset_id)" class="btn btn-primary">Download All</button>
                                <ul class="pagination pagination-no-border" id='collectionfiles_pagination_top' style="float: right;"></ul>
                                    <div class="table-full-width">
                                        <table class="table" id="files-table">
                                                <thead>
                                                        <th>Select</th>
                                                        <th>Name</th>
                                                        <th>Institution</th>
                                                        <th>Type</th>
                                                        <th>Description</th>
                                                        <th>Thumbnail</th>
                                                        <th>Size</th>
                                                        <th>Action</th>
                                                </thead>
                                            <tbody>
                                <center><img alt='Please wait while this is loading' id="loading_file" class="collapse show" height="50px" width="50px" src="/labcas-ui/assets/img/loading.gif"></center>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="card-footer ">
                                    <hr>
                                    <div class="stats">
                                        <i class="now-ui-icons loader_refresh spin"></i>
                                        <ul class="pagination pagination-no-border" id='collectionfiles_pagination_bottom' style="float: right;"></ul>

                                    </div>
                                </div>
                            </div>
                        </div>
	    </div>
        <div id='collection_level_schema_div' class="col-md-12 ml-auto mr-auto">
                  <div class="card card-tasks" id="collection_level_schema_metadata">
                    <div class="card-header ">
                      <h4 class="card-title">Schema Metdata</h4>
                      <p class="card-category">Interactively Explore</p>
                    </div>
                    <div class="card-body" style="padding: 0px 15px 10px 15px">
                      <div class="table-full-width">
                        <div id="collection_level_pcoa_div">
                          <center>
                            <iframe id="collection_level_schema_metadata_frame" style="border: none;" height="700px" width="100%"></iframe>
                          </center>
                        </div>
                      </div>
                    </div>
                </div>
	</div>

    <footer role='contentinfo' class='labcas-footer'  id="footer_template">
    </footer>
	    </div>
	</div>
    </div>
</div>
</div>
<div class="modal fade modal-mini modal-primary" id="redirectModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog" style="max-width: 1000px">
        <div class="modal-content" style="width: 1000px">
          <div class="modal-header justify-content-center">
            <div class="modal-profile">
              <i class="nc-icon nc-bell-55"></i>
            </div>
          </div>
          <div class="modal-body">
            <p>
            <center><div id='download_warning'></div></center>
            </p>
          </div>
          <div class="modal-footer">
              <!--<button type="submit" onclick="window.location.replace('/labcas-ui/download.html?version=5.5.2')" class="btn btn-info btn-fill pull-right" data-dismiss="modal">Continue</button>-->
            <button type="submit" class="btn btn-warning btn-fill pull-right" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>                        
</body>
<!--   Core JS Files   -->
<script src="/labcas-ui/assets/js/core/jquery-3.5.1.min.js" type="text/javascript"></script>
<script src="/labcas-ui/assets/js/core/popper.min.js" type="text/javascript"></script>
<script src="/labcas-ui/assets/js/core/bootstrap.min.js" type="text/javascript"></script>
<!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
<script src="/labcas-ui/assets/js/plugins/bootstrap-switch.js"></script>
<!--  Chartist Plugin  -->
<script src="/labcas-ui/assets/js/plugins/chartist.min.js"></script>
<!--  Notifications Plugin    -->
<script src="/labcas-ui/assets/js/plugins/bootstrap-notify.js"></script>
<!--  jVector Map  -->
<script src="/labcas-ui/assets/js/plugins/jquery-jvectormap.js" type="text/javascript"></script>
<!--  Plugin for Date Time Picker and Full Calendar Plugin-->
<script src="/labcas-ui/assets/js/plugins/moment.min.js"></script>
<!--  DatetimePicker   -->
<script src="/labcas-ui/assets/js/plugins/bootstrap-datetimepicker.js"></script>
<!--  Sweet Alert  -->
<script src="/labcas-ui/assets/js/plugins/sweetalert2.min.js" type="text/javascript"></script>
<!--  Tags Input  -->
<script src="/labcas-ui/assets/js/plugins/bootstrap-tagsinput.js" type="text/javascript"></script>
<!--  Sliders  -->
<script src="/labcas-ui/assets/js/plugins/nouislider.js" type="text/javascript"></script>
<!--  Bootstrap Select  -->
<script src="/labcas-ui/assets/js/plugins/bootstrap-selectpicker.js" type="text/javascript"></script>
<!--  jQueryValidate  -->
<script src="/labcas-ui/assets/js/plugins/jquery.validate.min.js" type="text/javascript"></script>
<!--  Plugin for the Wizard, full documentation here: https://github.com/VinceG/twitter-bootstrap-wizard -->
<script src="/labcas-ui/assets/js/plugins/jquery.bootstrap-wizard.js"></script>
<!--  Bootstrap Table Plugin -->
<script src="/labcas-ui/assets/js/plugins/bootstrap-table.js"></script>
<!--  DataTable Plugin -->
<script src="/labcas-ui/assets/js/plugins/jquery.dataTables.min.js"></script>
<!--  Full Calendar   -->
<script src="/labcas-ui/assets/js/plugins/fullcalendar.min.js"></script>
<!-- Control Center for Now Ui Dashboard: parallax effects, scripts for the example pages etc -->
<script src="/labcas-ui/assets/js/light-bootstrap-dashboard.js?v=2.0.1&2" type="text/javascript"></script>
<!-- Light Dashboard DEMO methods, don't include it in your project! -->
<!--<script src="/labcas-ui/assets/js/demo.js"></script>-->
<script src="/labcas-ui/assets/js/plugins/js.cookie.js"></script>
<script src="/labcas-ui/assets/js/plugins/typeahead.bundle.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.5.0/lz-string.min.js" integrity="sha512-qtX0GLM3qX8rxJN1gyDfcnMFFrKvixfoEOwbBib9VafR5vbChV5LeE5wSI/x+IlCkTY5ZFddFDCCfaVJJNnuKQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="/labcas-ui/assets/js/labcas/labcas-sidebar.js"></script>
<script src="/labcas-ui/assets/js/labcas/authentication.js?version=5.5.2"></script>
<script src="/labcas-ui/assets/js/labcas/utils.js?version=5.5.2"></script>
<script src="/labcas-ui/assets/js/labcas/search.js?version=5.5.2"></script>
<script src="/labcas-ui/assets/js/labcas/collections.js?version=5.5.2"></script>
<script src="/labcas-ui/assets/js/labcas/hierarchy_filter_utils.js?version=5.5.2"></script>
<script type="text/javascript">
    var get_var = get_url_vars();
    var collection_id = light_sanitize(get_var["collection_id"]);
    var dataset_id = collection_id+"/"+collection_id;
    $(document).ready(function() {
	initCookies();
	$("#collection_level_schema_div").hide();

       $( "#head_template" ).load("/labcas-ui/templates.html #head_template");
        $( "#nav_template" ).load("/labcas-ui/templates.html?2 #nav_template", function() {
            $( "#username_placeholder_second" ).text(Cookies.get('user'));
	    if (Cookies.get('user') == "Sign in"){$( "#username_placeholder_third" ).text(Cookies.get('user')); 
                $("#loggedout_msg").show();
            }else{
                $("#loggedout_msg").hide();
            }
        });
        //$( "#favorite_stat_template" ).load("/labcas-ui/templates.html #favorite_stat_template");
        $( "#download_collection_template" ).load("/labcas-ui/templates.html #download_collection_template");
        $( "#file_stat_template" ).load("/labcas-ui/templates.html #file_stat_template");
        $( "#dataset_stat_template" ).load("/labcas-ui/templates.html #dataset_stat_template");
        $( "#collection_name_template" ).load("/labcas-ui/templates.html #collection_name_template");

        $( "#footer_template" ).load("/labcas-ui/templates.html?version=5.5.2 #footer_template_"+localStorage.getItem("environment_name"));
        $( "#sidebar_placeholder" ).load("/labcas-ui/sidebar_"+localStorage.getItem("environment_name")+".html?9" );

        Cookies.set("login_redirect", "/labcas-ui/c/index.html?collection_id="+collection_id);
        setup_labcas_data("collectiondatasets",'id:"'+collection_id+'"', 'CollectionId:"'+collection_id+'"');
        $("#breadcrumb_collection").text(collection_id.replace(/_/g," "));

        //$('#collection_level_schema_metadata_frame').attr('src', '/labcas-ui/a/metadata_tables.html?collection_id='+collection_id);

        //Setup view tags
        var tagValues = ["Cohort","Fixative","Study","Gender","Animal Type","Stain"];
        var states = new Bloodhound({
                datumTokenizer: Bloodhound.tokenizers.obj.whitespace('value'),
                queryTokenizer: Bloodhound.tokenizers.whitespace,
                local: $.map(tagValues, function(tagValue) { return { value: tagValue }; })
        });

        states.initialize();
        var elt = $('#view_tags');
        elt.tagsinput({ itemValue: "value",
              typeaheadjs: {
              displayKey: 'value',
              source: states.ttAdapter()
              }
          });
        //elt.tagsinput('add', { "value": 1});
        $('#view_tag_select').change(function() {
                if (this.value != "Default"){
                    $('#datasets-table').hide();
                    $('#hierarchy_').show();
                    elt.tagsinput('add', { "value": this.value});
	            generate_hierarchy_based_on_tags().then(() => console.log('Parent function executed successfully'))
  .catch((error) => console.log(error));
                }else{
                    $('#hierarchy_').hide();
                    $('#datasets-table').show();
                }
        });
        localStorage.setItem("current_collection_id",collection_id);
        $('#view_tags').on('itemAdded itemRemoved', function(event) {
            $('#hierarchy_').html("");
	    //fill_hierarchy_data(collection_facets, collection_id, [], [], 0);
	    if (event.type == "itemRemoved"){
		    generate_hierarchy_based_on_tags().then(() => console.log('Parent function executed successfully'))
		  .catch((error) => console.log(error));
  	    }
            localStorage.setItem("hierarchy_tags_"+collection_id, elt.val());
        });
        $('.twitter-typeahead').hide();
            localStorage.setItem("last_collection_id", collection_id);
            init_file_checkboxes('none');
            obj_type = "collection";
            collection_hierarchy_get(collection_id);
	setTimeout(function() {
		generate_hierarchy_based_on_tags().then(() => console.log('Parent function executed successfully'))
.catch((error) => console.log(error));
	}, 1000);
    });
</script>

</html>
